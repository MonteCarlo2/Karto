# Настройка шаблона письма для сброса пароля KARTO

## Инструкция по настройке

### 1. Перейдите в Supabase Dashboard
1. Откройте [Supabase Dashboard](https://app.supabase.com)
2. Выберите ваш проект KARTO
3. Перейдите в раздел **Authentication** → **Email Templates**

### 2. Настройте шаблон "Reset Password"
1. Найдите шаблон **"Reset Password"** в списке
2. Нажмите на него для редактирования
3. Скопируйте содержимое из файла `PASSWORD_RESET_EMAIL_TEMPLATE.html`
4. Вставьте в поле **"Email Body"**

### 3. Настройте отправителя письма
1. Перейдите в **Authentication** → **Settings**
2. В разделе **"SMTP Settings"** настройте:
   - **From Email**: ваш email адрес (например, `noreply@karto.ru` или `support@karto.ru`)
   - **From Name**: `KARTO` (или ваше название)
   - **SMTP Host, Port, Username, Password**: настройки вашего SMTP сервера

### 4. Настройка логотипа в письме
**ВАЖНО:** После вставки шаблона в Supabase Dashboard:

1. Найдите строку с `<img src="https://YOUR_DOMAIN/logo-flow.png"`
2. Замените `YOUR_DOMAIN` на ваш реальный домен:
   - **Для продакшена:** `https://karto.ru` (или ваш домен)
   - **Для разработки:** `http://localhost:3000`
3. Убедитесь, что файлы `logo-flow.png` и `logo.png` доступны по этим путям

**Пример для продакшена:**
```html
<img src="https://karto.ru/logo-flow.png" alt="KARTO" ...>
```

**Пример для разработки:**
```html
<img src="http://localhost:3000/logo-flow.png" alt="KARTO" ...>
```

**Альтернатива: Использование хостинга изображений**
Если изображения не загружаются с вашего домена, используйте:
- **Imgur:** Загрузите логотип на imgur.com и используйте прямую ссылку
- **Cloudinary:** Загрузите на cloudinary.com
- **GitHub:** Используйте raw.githubusercontent.com (если логотип в репозитории)

**Пример с Imgur:**
```html
<img src="https://i.imgur.com/YOUR_IMAGE_ID.png" alt="KARTO" ...>
```

### 5. Переменные шаблона
Шаблон использует следующие переменные Supabase:
- `{{ .ConfirmationURL }}` - ссылка для сброса пароля

### 5. Альтернатива: Custom SMTP
Если у вас есть собственный SMTP сервер:
1. Включите **"Custom SMTP"** в настройках
2. Укажите параметры вашего SMTP сервера
3. Письма будут отправляться от вашего домена

### 6. Тестирование
1. Перейдите на страницу входа `/login`
2. Нажмите "Забыли?"
3. Введите email и отправьте запрос
4. Проверьте почтовый ящик - письмо должно прийти с вашим шаблоном

## Важные замечания

- **Логотип**: Убедитесь, что файлы `/logo-flow.png` и `/logo.png` доступны по указанным путям
- **Цвета**: Шаблон использует цвета бренда KARTO:
  - Основной зелёный: `#1F4E3D`
  - Фон: `#f5f3ef` (бежевый)
- **Срок действия ссылки**: По умолчанию ссылка действительна 1 час (настраивается в Supabase)

## Если письма не приходят

1. Проверьте настройки SMTP в Supabase
2. Проверьте спам-папку
3. Убедитесь, что домен не заблокирован почтовыми сервисами
4. Проверьте логи в Supabase Dashboard → Logs → Auth Logs
